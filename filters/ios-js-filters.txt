[AdBlock Plus 2.0]
! Title: JHS iOS Filters (JS)
! Version: 2024-11-12.1
! Expires: 1 days
! License: CC0-1.0
! Homepage: https://github.com/jocoro19/filter-lists

! Mobile YouTube
! Hide videos with less than 1000 views and streams with less than 50 watching
m.youtube.com##+js(rpnt, script, /(if \(document\.fonts &&)/, `var y = new MutationObserver(() => document.querySelectorAll(".watch-below-the-player ytm-video-with-context-renderer, [tab-identifier='FEwhat_to_watch'] ytm-rich-item-renderer").forEach(a => a.querySelectorAll("ytm-badge-and-byline-renderer > span").forEach(b => /^((?:No|[0-9]{0,3}) views?|(?:[1-4]?[0-9]) watching)$/.test(b.textContent) && (a.hidden = true)))); y.observe(document.body, { subtree: true, childList: true }); $1`)

! Disable muted autoplay on Mobile YouTube homepage, unmute videos by default, and hide "Open App" message
m.youtube.com##+js(rpnt, script, /(var ytcsi=)/, `document.head.insertAdjacentHTML("afterbegin", "<style>.ytp-unmute, .ytm-bottom-sheet-overlay-container:has([style*='/open-app.svg']), #global-loader:has(~ .ytm-bottom-sheet-overlay-container [style*='/open-app.svg']) { display: none !important; }</style>"); var w = new MutationObserver(() => { var a = document.querySelector("ytm-pages-dwell-detection"); a?.remove(); var b = document.querySelector(".ytp-unmute:not([style])"); b?.click(); b?.remove(); var c = document.querySelector("[style*='/open-app.svg'] button"); c?.click() }); w.observe(document.body, { subtree: true, childList: true }); $1`)

! Show chat on live streams
m.youtube.com##+js(rpnt, script, /(var ytcfg=)/, `var z = new MutationObserver(() => { var a = document.querySelector(".slim-video-action-bar-actions > button-view-model:first-of-type"); if (document.querySelector(".time-display-with-live-dot, .YtwPlayerTimeDisplayContentLiveDot") && !document.getElementById("openChat") && a) { var b = a.cloneNode(true); b.id = "openChat"; b.querySelector("div:has(> c3-icon) + div").textContent = "Open chat"; b.querySelector("div:has(> c3-icon) path").setAttribute("d", "M21 21H3V3h9v1H4v16h16v-8h1zM15 3v1h4.32l-8.03 8.03.71.71 8-8V9h1V3z"); b.onclick = () => window.open("https://www.youtube.com/live_chat?v=" + new URL(location.href).searchParams.get("v")); a.before(b)}; var c = document.querySelector(".YtwPlayerTimeDisplayContentLiveDot:not(.YtwPlayerTimeDisplayContentLiveDotHead)"); if (c) { c.addEventListener("click", () => { var d = document.querySelector("video"); d.currentTime = d.duration - 2 }, {once: true}) } }); z.observe(document.body, { subtree: true, childList: true }); $1`)
www.youtube.com##+js(rpnt, script, /(var ytcfg=)/, `location.pathname.startsWith("/@") && (location.hostname = "m.youtube.com"); location.pathname === "/live_chat" && document.head.insertAdjacentHTML("afterbegin", "<style>body { width: 50vw !important; height: 50vw !important; background-color: var(--yt-spec-base-background) !important; transform: scale(2); transform-origin: 0 0; overflow: clip !important;} yt-live-chat-app { width: 50vw !important; height: 50vh !important; } #items.yt-live-chat-item-list-renderer { pointer-events: none !important; } tp-yt-iron-dropdown { left: 25vw !important; top: 25vh !important; transform: translate(-50%, -50%) !important; } yt-live-chat-app:has(tp-yt-iron-dropdown:not([style*='display: none'])) > #contents { filter: brightness(0.5); } yt-live-chat-renderer iron-pages:has(> #input-panel) { border-bottom: none !important; }</style>"); $1`)

! Return YouTube Dislike (data from returnyoutubedislike.com)
m.youtube.com##+js(rpnt, script, /(var setMessage=)/, `(()=>{const t=document.querySelector.bind(document),e=document.getElementById.bind(document);let o,n,i,s,l,a=0,c=0,r="/watch"===location.pathname,d=location.pathname.startsWith("/shorts/");function u(o){if(e("dislikeCount"))e("dislikeCount").textContent=h(o);else{const e=l.cloneNode();if(e.textContent=h(o),r){const o=t("dislike-button-view-model button");o.style.width="auto";const n=o.querySelector(".yt-spec-button-shape-next__icon");n.style.marginLeft="-5px",n.after(e)}if(d){const o=t("ytm-toggle-button-renderer:last-child div > span");o&&(o.innerHTML=e.outerHTML)}}}function h(t){let e;return t<1e3?t:(t<1e4?e=Math.floor(t/100)/10+"K":t<1e6?e=Math.floor(t/1e3)+"K":t<1e7?e=Math.floor(t/1e5)/10+"M":t>=1e7&&(e=Math.floor(t/1e6)+"M"),e&&e.replace(".0",""))}new MutationObserver((()=>{function h(){a&&s.abort(),a=0,o=0,c=0}r="/watch"===location.pathname,d=location.pathname.startsWith("/shorts/"),r||(n=""),d||(i=""),r||d||h(),r&&location.search&&n!==location.search&&(n=location.search,h()),d&&location.pathname.startsWith("/shorts/")&&i!==location.pathname.slice(8)&&(i=location.pathname.slice(8),h()),c&&!e("dislikeCount")&&u(o),t(r?"dislike-button-view-model":d&&"ytm-toggle-button-renderer:last-child")&&function(){if(!a){s=new AbortController,a=1,console.log("Getting dislike count...");const e=new URL(location.href),h=r&&e.searchParams.get("v")||d&&e.pathname.slice(8);fetch("https://returnyoutubedislikeapi.com/votes?videoId="+h,{cache:"no-cache",method:"GET",signal:s.signal}).then((t=>t.json())).then((e=>{"dislikes"in e&&(console.log("Dislikes:",e.dislikes),o=e.dislikes,l=document.createElement("span"),l.id="dislikeCount",r&&(n||(n=location.search),l.style.marginLeft="6px"),d&&!i&&(i=location.pathname.slice(8)),c=1,u(o),function(){let e;const n=t(r?"dislike-button-view-model button":d&&"ytm-toggle-button-renderer:last-child button");if("dislikeButton"!==n.id){n.id="dislikeButton","true"===n.ariaPressed&&(e=!0),n.addEventListener("click",(()=>{"true"===n.ariaPressed&&(++o,u(o),e=!0),"false"===n.ariaPressed&&(--o,u(o),e=!1)}));const i=t(r?"like-button-view-model button":d&&"ytm-toggle-button-renderer:first-child button");i.addEventListener("click",(()=>{"true"===i.ariaPressed&&!0===e&&(--o,u(o),e=!1)}))}}())}))}}()})).observe(document.documentElement,{childList:!0,subtree:!0})})(); $1`)

! SponsorBlock (data from sponsor.ajay.app)
m.youtube.com##+js(rpnt, script, /(var setMessage=)/, `(()=>{const e=document.querySelector.bind(document),t=document.getElementById.bind(document);let o,n,s,r,i,a=[],c=0,l=!0;if(window.trustedTypes&&trustedTypes.createPolicy&&!trustedTypes.defaultPolicy){const e=e=>e;trustedTypes.createPolicy("default",{createHTML:e,createScriptURL:e,createScript:e})}new MutationObserver((()=>{"/watch"===location.pathname&&e("video")?.duration&&function(){if(!c){r=new AbortController,c=1,o=e("video"),s=location.search;const d=new URL(location.href).searchParams.get("v");fetch('https://sponsor.ajay.app/api/skipSegments?categories=["sponsor","poi_highlight"]&videoID='+d,{cache:"no-cache",method:"GET",signal:r.signal}).then((e=>e.ok&&e.json())).then((s=>{if(s){const r=s.filter((e=>"sponsor"===e.category&&e.segment[1]-e.segment[0]>=10||"poi_highlight"===e.category));r.length>0&&(r.forEach((e=>{a.push({type:e.category,start:e.segment[0],end:e.segment[1]})})),localStorage.getItem("skipDisabled")&&(l=!1),function(){const e=o.duration,t=document.createElement("div");t.id="segmentContainer",t.style.cssText="width: 100%; height: 3px; position: absolute;",a.forEach(((o,n)=>{const s=document.createElement("div");s.style.cssText="min-width: 1px; height: inherit; opacity: 0.7; position: absolute;",s.style.left=o.start/e*100+"%",o.start!==o.end?s.style.right=100*(1-o.end/e)+"%":s.style.width="4px","sponsor"===o.type&&(s.style.backgroundColor="#00d400"),"poi_highlight"===o.type&&(s.style.backgroundColor="#00b3ff"),o.marker=s,t.appendChild(s)})),n=t}(),o.addEventListener("timeupdate",(()=>{const n=a.filter((e=>"sponsor"===e.type&&o.currentTime>=e.start&&o.currentTime<e.end))[0];if(n){if(l)o.currentTime=n.end;else if(!t("sponsor-info")){const t=document.createElement("div"),s=Math.floor(n.end/3600),r=Math.floor(n.end%3600/60),i=Math.floor(n.end%60);t.id="sponsor-info",t.textContent="Â·  Sponsor (until "+(s?s+":"+(r+":").padStart(3,"0"):r+":")+String(i).padStart(2,"0")+")",t.style.cssText="pointer-events: auto; white-space: nowrap; margin-left: 4px;",e(".YtwPlayerTimeDisplayContent").appendChild(t),t.addEventListener("click",(()=>o.currentTime=n.end)),(chapter=e(".YtwPlayerTimeDisplayPlaybarActionContainer"))&&(chapter.style.order="1")}}else t("sponsor-info")&&t("sponsor-info").remove()})),i=document.createElement("div"),i.innerHTML='<button class="icon-button" id="skip-button"><svg viewBox="0 0 565.15 568" style="fill: currentColor; height: 24px;"><path d="M282.58 568a65 65 0 0 1-34.14-9.66C95.41 463.94 2.54 300.46 0 121a64.91 64.91 0 0 1 34-58.09 522.56 522.56 0 0 1 497.16 0 64.91 64.91 0 0 1 34 58.12c-2.53 179.43-95.4 342.91-248.42 437.3a65 65 0 0 1-34.16 9.67m0-548.31A502.24 502.24 0 0 0 43.4 80.22a45.27 45.27 0 0 0-23.7 40.53c2.44 172.67 91.81 330 239.07 420.83a46.19 46.19 0 0 0 47.61 0C453.64 450.73 543 293.42 545.45 120.75a45.26 45.26 0 0 0-23.7-40.54 502.26 502.26 0 0 0-239.17-60.52"/><path d="M284.705 42.693A479.9 479.9 0 0 0 54.37 100.42a22.53 22.53 0 0 0-11.7 20c2.4 169.84 93.001 318.22 228.161 401.59a22.48 22.48 0 0 0 23.49 0c135.16-83.37 225.76-231.75 228.16-401.59a22.53 22.53 0 0 0-11.7-20 479.9 479.9 0 0 0-226.075-57.727M220.41 145.74l190.87 110.2-190.87 110.2z"/></svg></button>',i.style.order="-1")}}))}}(),n&&!t("segmentContainer")&&function(){const o=n.cloneNode(!0),s=e(".YtProgressBarLineProgressBarLine, .YtChapteredProgressBarHost");s?.appendChild(o),a.some((e=>"sponsor"===e.type))&&e("player-top-controls > div")&&!t("skip-button")&&function(){const t=i.cloneNode(!0),o=t.querySelector("path[d^='M284']");l||(o.style.display="none");t.addEventListener("click",(()=>{l?(l=!1,localStorage.setItem("skipDisabled","true"),o.style.display="none"):l||(l=!0,localStorage.removeItem("skipDisabled"),o.style.cssText="")})),e("player-top-controls > div").appendChild(t)}()}(),c&&location.search!==s&&(s=location.search,n=void 0,o=void 0,a=[],r.abort(),c=0)})).observe(document.documentElement,{childList:!0,subtree:!0})})(); $1`)

! Other
danbooru.donmai.us##+js(rpnt, script, /(\$\(function\(\))/, `if (/^\/posts\/\d*$/.test(location.pathname)) { var x = new URL(location.href); x.searchParams.delete("q"); history.replaceState(null, "", x.href) }; $1`)
gelbooru.com##+js(rpnt, script, /(function responsiveViewToggle\(\))/, `document.querySelectorAll(".mobileActions a[target='_blank']").forEach(a => a.removeAttribute("target")); document.head.insertAdjacentHTML("afterbegin", "<style>.headerAd, div[style*='height:']:has(> [id^='ts_ad_']), .mobileActions .showEditBox { display: none !important; }</style>"); var x = document.querySelectorAll(".thumbnail-container"); location.search.includes("s=list") && x.length == 2 && (x[0].innerHTML += x[1].innerHTML, x[1].remove()); document.querySelectorAll(".thumbnail-preview a").forEach(a => { var b = new URL(a.href); b.searchParams.delete("tags"); a.href = b.href }); $1`)
medibang.com##+js(rpnt, script, /(var ROOT_URL =)/, `var x = new MutationObserver(() => document.querySelectorAll(".illust-item_box a").forEach(a => a.href = a.href.replace(".com/picture/viewer/", ".com/picture/"))); location.pathname === "/contentsSearch/" && x.observe(document.body, { subtree: true, childList: true }); /^\/picture\//.test(location.pathname) && document.querySelectorAll(".pictureDetails__image > a").forEach(b => { delete b.dataset.zoomUrl; b.href = b.querySelector("img").src.replace("/1280_960/", "/") }); $1`)
toyhou.se##+js(rpnt, script, /(var modalCount)/, `(()=>{const e=document.querySelector(".content-warning");function t(){document.querySelectorAll(".character-favorites a").forEach((e=>e.href+="/favorites"))}e&&(e.style.display="none",e.querySelector("button.btn-success").click()),t();new MutationObserver(t).observe(document.querySelector(".modal-content"),{childList:!0})})(); $1`)

piokok.com##+js(rpnt, script, /var api=/, `(()=>{document.querySelectorAll(".pic > a").forEach(a=>a.removeAttribute("target"));function t(){document.querySelectorAll(".cover_link").forEach(a=>a.removeAttribute("target"));document.querySelectorAll(".meta a[href^='/tag/']").forEach((t=>{const e=t.nextSibling;if(e?.textContent.startsWith(" _")){const n=e.textContent.match(/^ (_\S*)/)[1];e.textContent=e.textContent.replace(n,""),t.href=t.href.replace(/\/$/,n+"/"),t.textContent+=n}}))}if(t(),location.pathname.startsWith("/profile/")){new MutationObserver(t).observe(document.querySelector(".items"),{childList:!0})}})(); $&`)
picuki.com##+js(rpnt, script, /var isAdBlockActive=/, `(()=>{if(/^\/(profile|tag)\//.test(location.pathname)){function e(){document.querySelectorAll("div.photo-description:not(:has(.tag)), .photo-action-description").forEach((e=>{e.innerHTML.includes("#")&&(e.innerHTML=e.innerHTML.replaceAll(/#(\S+)/g,"<a class='tag' href='/tag/$1'>#$1</a>"))}))}e();new MutationObserver(e).observe(document.querySelector(".box-photos"),{childList:!0})}if(location.pathname.startsWith("/media/")){const t=document.querySelector("div.single-photo-description");if(t.innerHTML=t.innerHTML.replaceAll(/@([a-zA-Z0-9._]+)/g,"<a href='https://www.picuki.com/profile/$1'>@$1</a>"),document.querySelector(".tagged")){document.querySelectorAll(".tagged > div > div").forEach((e=>{e.innerHTML=e.innerHTML.replace(/@([a-zA-Z0-9._]+)/g,"<a href='https://www.picuki.com/profile/$1'>@$1</a>")}))}if(document.querySelectorAll(".single-photo video").forEach((e=>{const t=e.parentElement.getAttribute("onclick");e.parentElement.removeAttribute("onclick"),e.nextElementSibling.setAttribute("onclick",t)})),"function"==typeof downloadPhoto){const o=document.querySelector(".download_button");o.className="fixed-download-button",o.addEventListener("click",(()=>{const e=document.querySelector(".owl-item.active > .item")||document.querySelector(".single-photo"),t=e.firstElementChild.src||e.querySelector("source").src;downloadPhoto(t)}))}}})(); $&`)
