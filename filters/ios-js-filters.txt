[AdBlock Plus 2.0]
! Title: JHS iOS Filters (JS)
! Version: 2024-03-23.3
! Expires: 1 days
! License: CC0-1.0
! Homepage: https://github.com/jocoro19/filter-lists

! Mobile YouTube
! Hide videos with less than 1000 views and streams with less than 50 watching
m.youtube.com##+js(rpnt, script, /(if \(document\.fonts &&)/, `var y = new MutationObserver(() => document.querySelectorAll(".watch-below-the-player ytm-video-with-context-renderer, [tab-identifier='FEwhat_to_watch'] ytm-rich-item-renderer").forEach(a => a.querySelectorAll("ytm-badge-and-byline-renderer > span").forEach(b => /^((?:No|[0-9]{0,3}) views?|(?:[1-4]?[0-9]) watching)$/.test(b.textContent) && (a.hidden = true)))); y.observe(document.body, { subtree: true, childList: true }); $1`)

! Disable muted autoplay on Mobile YouTube homepage, unmute videos by default, and hide "Open App" message
m.youtube.com##+js(rpnt, script, /(var ytcsi=)/, `document.head.insertAdjacentHTML("afterbegin", "<style>.ytp-unmute, .ytm-bottom-sheet-overlay-container:has([style*='/open-app.svg']), #global-loader:has(~ .ytm-bottom-sheet-overlay-container [style*='/open-app.svg']) { display: none !important; }</style>"); var w = new MutationObserver(() => { var a = document.querySelector("ytm-pages-dwell-detection"); a && a.remove(); var b = document.querySelector(".ytp-unmute:not([style])"); b && (b.click(), b.remove()); var c = document.querySelector("[style*='/open-app.svg'] button"); c && c.click() }); w.observe(document.body, { subtree: true, childList: true }); $1`)

! Show chat on live streams
m.youtube.com##+js(rpnt, script, /(var ytcfg=)/, `var z = new MutationObserver(() => { var a = document.querySelector(".slim-video-action-bar-actions > button-view-model:first-of-type"); if (document.querySelector(".time-display-with-live-dot") && !document.getElementById("openChat") && a) { var b = a.cloneNode(true); b.id = "openChat"; b.querySelector("div:has(> c3-icon) + div").textContent = "Open chat"; b.querySelector("div:has(> c3-icon) path").setAttribute("d", "M21 21H3V3h9v1H4v16h16v-8h1zM15 3v1h4.32l-8.03 8.03.71.71 8-8V9h1V3z"); b.onclick = () => window.open("https://www.youtube.com/live_chat?v=" + new URL(location.href).searchParams.get("v")); a.before(b)} }); z.observe(document.body, { subtree: true, childList: true }); $1`)
www.youtube.com##+js(rpnt, script, /(var ytcfg=)/, `location.pathname === "/live_chat" && document.head.insertAdjacentHTML("afterbegin", "<style>body { width: 50vw !important; height: 50vw !important; background-color: var(--yt-spec-base-background) !important; transform: scale(2); transform-origin: 0 0; overflow: clip !important;} yt-live-chat-app { width: 50vw !important; height: 50vh !important; } tp-yt-iron-dropdown { left: 25vw !important; top: 25vh !important; transform: translate(-50%, -50%) !important; } yt-live-chat-app:has(tp-yt-iron-dropdown:not([style*='display: none'])) > #contents { filter: brightness(0.5); } yt-live-chat-renderer iron-pages:has(> #input-panel) { border-bottom: none !important; } #show-more { display: none !important; }</style>"); $1`)

! Return YouTube Dislike (data from returnyoutubedislike.com)
m.youtube.com##+js(rpnt, script, /(var setMessage=)/, `(()=>{let dislikes,requestSent=0,dislikeCountSet=0,query=location.search;const observer=new MutationObserver(()=>{document.querySelector("dislike-button-view-model")&&getDislikeCount(),dislikeCountSet&&!document.getElementById("dislikeCount")&&setDislikeCount(dislikes),query!==location.search&&(query=location.search,requestSent=0,dislikeCountSet=0)});function getDislikeCount(){if(!requestSent&&"/watch"===location.pathname){requestSent=1;let e=new URL(location.href).searchParams.get("v");fetch("https://returnyoutubedislikeapi.com/votes?videoId="+e,{method:"GET",cache:"no-cache"}).then(e=>e.json()).then(e=>{"dislikes"in e&&(dislikes=e.dislikes,setDislikeCount(e.dislikes),dislikeEventListener())})}}function setDislikeCount(e){if(document.getElementById("dislikeCount"))document.getElementById("dislikeCount").textContent=round(e);else{let t=document.querySelector("like-button-view-model .yt-spec-button-shape-next__button-text-content").cloneNode(),i=document.querySelector("dislike-button-view-model button"),s=i.querySelector(".yt-spec-button-shape-next__icon");t.id="dislikeCount",t.textContent=round(e),i.style.width="auto",t.style.marginLeft="6px",s.after(t),dislikeCountSet=1}}function dislikeEventListener(){let e=document.querySelector("dislike-button-view-model button");"dislikeButton"!==e.id&&(e.id="dislikeButton",e.addEventListener("click",()=>{"true"===e.ariaPressed&&setDislikeCount(++dislikes),"false"===e.ariaPressed&&setDislikeCount(--dislikes)}))}function round(e){let t;return e<1e3?e:(e<1e4?t=Math.floor(e/100)/10+"K":e<1e6?t=Math.floor(e/1e3)+"K":e<1e7?t=Math.floor(e/1e5)/10+"M":e>=1e7&&(t=Math.floor(e/1e6)+"M"),t&&t.replace(".0",""))}observer.observe(document.body,{childList:!0,subtree:!0})})(); $1`)

! Other
danbooru.donmai.us##+js(rpnt, script, /(\$\(function\(\))/, `if (/^\/posts\/\d*$/.test(location.pathname)) { var x = new URL(location.href); x.searchParams.delete("q"); history.replaceState(null, "", x.href) }; $1`)
gelbooru.com##+js(rpnt, script, /(function responsiveViewToggle\(\))/, `document.head.insertAdjacentHTML("afterbegin", "<style>div:has(> [id^='ts_ad_']), .mobileActions .showEditBox { display: none !important; }</style>"); var x = document.querySelectorAll(".thumbnail-container"); location.search.includes("s=list") && x.length == 2 && (x[0].innerHTML += x[1].innerHTML, x[1].remove()); document.querySelectorAll(".thumbnail-preview a").forEach(a => { var b = new URL(a.href); b.searchParams.delete("tags"); a.href = b.href }); $1`)
medibang.com##+js(rpnt, script, /(var ROOT_URL =)/, `var x = new MutationObserver(() => document.querySelectorAll(".illust-item_box a").forEach(a => a.href = a.href.replace(".com/picture/viewer/", ".com/picture/"))); location.pathname === "/contentsSearch/" && x.observe(document.body, { subtree: true, childList: true }); /^\/picture\//.test(location.pathname) && document.querySelectorAll(".pictureDetails__image > a").forEach(b => { delete b.dataset.zoomUrl; b.href = b.querySelector("img").src.replace("/1280_960/", "/") }); $1`)
